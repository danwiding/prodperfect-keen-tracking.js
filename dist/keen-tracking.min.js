!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var o in n)("object"==typeof exports?exports:e)[o]=n[o]}}(window,function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=30)}([function(e,t){e.exports=function(e,t,n){var o;if(!e)return 0;if(n=n||e,e instanceof Array){for(o=0;o<e.length;o++)if(!1===t.call(n,e[o],o,e))return 0}else for(o in e)if(e.hasOwnProperty(o)&&!1===t.call(n,e[o],o,e))return 0;return 1}},function(e,t){e.exports=function(e){for(var t=1;t<arguments.length;t++)for(var n in arguments[t])e[n]=arguments[t][n];return e}},function(e,t,n){function o(e){if(e)return function(e){for(var t in o.prototype)e[t]=o.prototype[t];return e}(e)}e.exports=o,o.prototype.on=o.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},o.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},o.prototype.off=o.prototype.removeListener=o.prototype.removeAllListeners=o.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,o=this._callbacks["$"+e];if(!o)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r=0;r<o.length;r++)if((n=o[r])===t||n.fn===t){o.splice(r,1);break}return this},o.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var o=0,r=(n=n.slice(0)).length;o<r;++o)n[o].apply(this,t);return this},o.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},o.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(29)),r=(i(n(0)),i(n(1)),n(9));function i(e){return e&&e.__esModule?e:{default:e}}o.default.helpers=o.default.helpers||{},o.default.on("client",function(e){e.extensions={events:[],collections:{}},e.queue=(0,r.queue)(),e.queue.on("flush",function(){e.recordDeferredEvents()})}),o.default.prototype.writeKey=function(e){return arguments.length?(this.config.writeKey=e?String(e):null,this):this.config.writeKey},o.default.prototype.setGlobalProperties=function(e){if(o.default.log("This method has been deprecated. Check out #extendEvents: https://github.com/keen/keen-tracking.js#extend-events"),e&&"function"==typeof e)return this.config.globalProperties=e,this;this.emit("error","Invalid value for global properties: "+e)},t.default=o.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDomNodePath=function(e){if(!e.nodeName)return"";var t=[];for(;null!=e.parentNode;){for(var n=0,o=0,r=0;r<e.parentNode.childNodes.length;r++){var i=e.parentNode.childNodes[r];i.nodeName==e.nodeName&&(i===e&&(o=n),n++)}e.hasAttribute("id")&&""!=e.id?t.unshift(e.nodeName.toLowerCase()+"#"+e.id):n>1?t.unshift(e.nodeName.toLowerCase()+":eq("+o+")"):t.unshift(e.nodeName.toLowerCase()),e=e.parentNode}return t.slice(1).join(" > ")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getWindowProfile=function(){var e,t,n;if("undefined"==typeof document)return{};e=document.body,t=document.documentElement,n={height:"innerHeight"in window?window.innerHeight:document.documentElement.offsetHeight,width:"innerWidth"in window?window.innerWidth:document.documentElement.offsetWidth,scrollHeight:Math.max(e.scrollHeight,e.offsetHeight,t.clientHeight,t.scrollHeight,t.offsetHeight)||null},window.screen&&(n.ratio={height:window.screen.availHeight?parseFloat((window.innerHeight/window.screen.availHeight).toFixed(2)):null,width:window.screen.availWidth?parseFloat((window.innerWidth/window.screen.availWidth).toFixed(2)):null});return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getScreenProfile=function(){var e,t;if("undefined"==typeof window||!window.screen)return{};e=["height","width","colorDepth","pixelDepth","availHeight","availWidth"],t={};for(var n=0;n<e.length;n++)t[e[n]]=window.screen[e[n]]?window.screen[e[n]]:null;return t.orientation={angle:window.screen.orientation?window.screen.orientation.angle:0,type:window.innerWidth>window.innerHeight?"landscape":"portrait"},t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.deepExtend=function e(t){for(var n=1;n<arguments.length;n++)if(t instanceof Array&&arguments[n]instanceof Array)for(var i=0;i<arguments[n].length;i++)t.indexOf(arguments[n][i])<0&&t.push(arguments[n][i]);else for(var s in arguments[n])void 0!==t[s]&&"object"===o(arguments[n][s])&&null!==arguments[n][s]?e(t[s],r(arguments[n][s])):void 0!==arguments[n][s]&&"function"!=typeof arguments[n][s]&&(t[s]=r(arguments[n][s]));return t};function r(e){return JSON.parse(JSON.stringify(e))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.extendEvent=function(e,t){if(2!==arguments.length||"string"!=typeof e||"object"!==(void 0===t?"undefined":o(t))&&"function"!=typeof t)return void c.call(this,"Incorrect arguments provided to #extendEvent method");return this.extensions.collections[e]=this.extensions.collections[e]||[],this.extensions.collections[e].push(t),this.emit("extendEvent",e,t),this},t.extendEvents=function(e){if(1!==arguments.length||"object"!==(void 0===e?"undefined":o(e))&&"function"!=typeof e)return void c.call(this,"Incorrect arguments provided to #extendEvents method");return this.extensions.events.push(e),this.emit("extendEvents",e),this},t.getExtendedEventBody=function(e,t){t&&t.length>0&&(0,u.default)(t,function(t,n){var o="function"==typeof t?t():t;(0,i.deepExtend)(e,o)});return e};var r,i=n(7),s=n(0),u=(r=s)&&r.__esModule?r:{default:r};function c(e){var t="Event(s) not extended: "+e;this.emit("error",t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.queue=i;var o,r=n(2);function i(){return this instanceof i==!1?new i:(this.capacity=0,this.config={capacity:5e3,interval:15},this.events={},this.interval=0,this.timer=null,this)}(0,((o=r)&&o.__esModule?o:{default:o}).default)(i.prototype),i.prototype.check=function(){return function(e){if(e.capacity>0&&e.interval>=e.config.interval)return!0;if(e.capacity>=e.config.capacity)return!0;return!1}(this)&&this.flush(),0!==this.config.interval&&0!==this.capacity||this.pause(),this},i.prototype.flush=function(){return this.emit("flush"),this.interval=0,this},i.prototype.pause=function(){return this.timer&&(clearInterval(this.timer),this.timer=null),this},i.prototype.start=function(){var e=this;return e.pause(),e.timer=setInterval(function(){e.interval++,e.check()},1e3),e}},function(e,t,n){"use strict";function o(e){return this instanceof o==!1?new o(e):(this.count=e||0,this)}Object.defineProperty(t,"__esModule",{value:!0}),t.timer=o,o.prototype.start=function(){var e=this;return this.pause(),this.interval=setInterval(function(){e.count++},1e3),this},o.prototype.pause=function(){return clearInterval(this.interval),this},o.prototype.value=function(){return this.count},o.prototype.clear=function(){return this.count=0,this}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.serializeForm=function(e,t){"object"!=(void 0===t?"undefined":o(t))?t={hash:!!t}:void 0===t.hash&&(t.hash=!0);for(var n=t.hash?{}:"",s=t.serializer||(t.hash?u:c),a=e&&e.elements?e.elements:[],l=Object.create(null),d=0;d<a.length;++d){var f=a[d];if(!(t.ignoreTypes&&t.ignoreTypes.indexOf(f.type)>-1)&&((t.disabled||!f.disabled)&&f.name&&i.test(f.nodeName)&&!r.test(f.type))){var p=f.name,h=f.value;if("checkbox"!==f.type&&"radio"!==f.type||f.checked||(h=void 0),t.empty){if("checkbox"!==f.type||f.checked||(h=""),"radio"===f.type&&(l[f.name]||f.checked?f.checked&&(l[f.name]=!0):l[f.name]=!1),void 0==h&&"radio"==f.type)continue}else if(!h)continue;if("select-multiple"!==f.type)n=s(n,p,h);else{h=[];for(var m=f.options,g=!1,v=0;v<m.length;++v){var y=m[v],b=t.empty&&!y.value,w=y.value||b;y.selected&&w&&(g=!0,n=t.hash&&"[]"!==p.slice(p.length-2)?s(n,p+"[]",y.value):s(n,p,y.value))}!g&&t.empty&&(n=s(n,p,""))}}}if(t.empty)for(var p in l)l[p]||(n=s(n,p,""));return n};var r=/^(?:submit|button|image|reset|file)$/i,i=/^(?:input|select|textarea|keygen)/i,s=/(\[[^\[\]]*\])/g;function u(e,t,n){if(t.match(s)){!function e(t,n,o){if(0===n.length)return t=o;var r=n.shift(),i=r.match(/^\[(.+?)\]$/);if("[]"===r)return t=t||[],Array.isArray(t)?t.push(e(null,n,o)):(t._values=t._values||[],t._values.push(e(null,n,o))),t;if(i){var s=i[1],u=+s;isNaN(u)?(t=t||{})[s]=e(t[s],n,o):(t=t||[])[u]=e(t[u],n,o)}else t[r]=e(t[r],n,o);return t}(e,function(e){var t=[],n=new RegExp(s),o=/^([^\[\]]*)/.exec(e);for(o[1]&&t.push(o[1]);null!==(o=n.exec(e));)t.push(o[1]);return t}(t),n)}else{var o=e[t];o?(Array.isArray(o)||(e[t]=[o]),e[t].push(n)):e[t]=n}return e}function c(e,t,n){return n=n.replace(/(\r)?\n/g,"\r\n"),n=(n=encodeURIComponent(n)).replace(/%20/g,"+"),e+(e?"&":"")+encodeURIComponent(t)+"="+n}},function(e,t,n){var o,r;
/*!
 * JavaScript Cookie v2.1.0
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */void 0===(r="function"==typeof(o=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var o in n)t[o]=n[o]}return t}return function t(n){function o(t,r,i){var s;if(arguments.length>1){if("number"==typeof(i=e({path:"/"},o.defaults,i)).expires){var u=new Date;u.setMilliseconds(u.getMilliseconds()+864e5*i.expires),i.expires=u}try{s=JSON.stringify(r),/^[\{\[]/.test(s)&&(r=s)}catch(e){}return r=n.write?n.write(r,t):encodeURIComponent(String(r)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=(t=(t=encodeURIComponent(String(t))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape),document.cookie=[t,"=",r,i.expires&&"; expires="+i.expires.toUTCString(),i.path&&"; path="+i.path,i.domain&&"; domain="+i.domain,i.secure?"; secure":""].join("")}t||(s={});for(var c=document.cookie?document.cookie.split("; "):[],a=/(%[0-9A-Z]{2})+/g,l=0;l<c.length;l++){var d=c[l].split("="),f=d[0].replace(a,decodeURIComponent),p=d.slice(1).join("=");'"'===p.charAt(0)&&(p=p.slice(1,-1));try{if(p=n.read?n.read(p,f):n(p,f)||p.replace(a,decodeURIComponent),this.json)try{p=JSON.parse(p)}catch(e){}if(t===f){s=p;break}t||(s[f]=p)}catch(e){}}return s}return o.get=o.set=o,o.getJSON=function(){return o.apply({json:!0},[].slice.call(arguments))},o.defaults={},o.remove=function(t,n){o(t,"",e(n,{expires:-1}))},o.withConverter=t,o}(function(){})})?o.call(t,n,t,e):o)||(e.exports=r)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cookie=void 0;var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=s(n(12)),i=s(n(1));function s(e){return e&&e.__esModule?e:{default:e}}var u=t.cookie=function e(t){if(arguments.length)return this instanceof e==!1?new e(t):(this.config={key:t,options:{expires:365}},this.data=this.get(),this)};u.prototype.get=function(e){var t={};return r.default.get(this.config.key)&&(t=r.default.getJSON(this.config.key)),e&&"object"===(void 0===t?"undefined":o(t))&&null!==typeof t?void 0!==t[e]?t[e]:null:t},u.prototype.set=function(e,t,n){return arguments.length&&this.enabled()?("string"==typeof e&&arguments.length>=2?this.data[e]=t||null:"object"===(void 0===e?"undefined":o(e))&&1===arguments.length&&(0,i.default)(this.data,e),r.default.set(this.config.key,this.data,(0,i.default)(this.config.options,n||{})),this):this},u.prototype.expire=function(e){return e?r.default.set(this.config.key,this.data,(0,i.default)(this.config.options,{expires:e})):(r.default.remove(this.config.key),this.data={}),this},u.prototype.options=function(e){return arguments.length?(this.config.options="object"===(void 0===e?"undefined":o(e))?e:{},this):this.config.options},u.prototype.enabled=function(){return navigator.cookieEnabled}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUniqueId=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.getScrollState=function(e){var t="object"===(void 0===e?"undefined":o(e))?e:{},n=(0,s.default)({pixel:0,pixel_max:0,ratio:null,ratio_max:null},t);void 0===("undefined"==typeof window?"undefined":o(window))&&void 0===("undefined"==typeof document?"undefined":o(document))||(n.pixel=(void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop)+(window.innerHeight||document.documentElement.clientHeight),n.pixel>n.pixel_max&&(n.pixel_max=n.pixel),n.ratio=parseFloat(Number(n.pixel/u()).toFixed(2)),n.ratio_max=parseFloat(Number(n.pixel_max/u()).toFixed(2)));return n};var r,i=n(1),s=(r=i)&&r.__esModule?r:{default:r};function u(){var e=document.body,t=document.documentElement;return Math.max(e.scrollHeight,e.offsetHeight,t.clientHeight,t.scrollHeight,t.offsetHeight)||null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDomNodeProfile=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{action:e.action,class:e.className,href:e.href||null,id:e.id,method:e.method,name:e.name,ng_click:e.getAttribute("ng-click"),ng_model:e.getAttribute("ng-model"),node_name:e.nodeName,selector:(0,o.getDomNodePath)(e),text:e.text,textContent:r(e,t),title:e.title,type:e.type,x_position:e.offsetLeft||e.clientLeft||null,y_position:e.offsetTop||e.clientTop||null}};var o=n(4),r=function(e,t){return t.recordTextContent&&e.textContent?t.redactTextContent?"---REDACTED---":e.textContent:null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDomainName=function(e){var t=function(e){var t;t=e.indexOf("://")>-1?e.split("/")[2]:e.split("/")[0];return t=(t=t.split(":")[0]).split("?")[0]}(e),n=t.split("."),o=n.length;o>2&&(t=n[o-2]+"."+n[o-1],2==n[o-2].length&&2==n[o-1].length&&(t=n[o-3]+"."+t));return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDatetimeIndex=function(e){var t=e||new Date;return{hour_of_day:t.getHours(),day_of_week:parseInt(1+t.getDay()),day_of_month:t.getDate(),month:parseInt(1+t.getMonth()),year:t.getFullYear()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBrowserProfile=function(){return{cookies:void 0!==navigator.cookieEnabled&&navigator.cookieEnabled,codeName:navigator.appCodeName,description:function(){var e;document&&"function"==typeof document.querySelector&&(e=document.querySelector('meta[name="description"]'));return e?e.content:""}(),language:navigator.language,name:navigator.appName,online:navigator.onLine,platform:navigator.platform,useragent:navigator.userAgent,version:navigator.appVersion,screen:(0,o.getScreenProfile)(),window:(0,r.getWindowProfile)()}};var o=n(6),r=n(5)},function(e){e.exports={name:"keen-tracking",version:"2.0.2",upstreamVersion:"2.0.1",description:"Data Collection SDK for Keen IO",main:"dist/node/keen-tracking.js",browser:"dist/keen-tracking.js",repository:{type:"git",url:"https://github.com/keen/keen-tracking.js.git"},scripts:{start:"NODE_ENV=development webpack-dev-server",test:"NODE_ENV=test jest && NODE_ENV=test TEST_ENV=node jest","test:watch":"NODE_ENV=test jest --watch","test:node:watch":"NODE_ENV=test TEST_ENV=node jest --watch","test:regression":"npm run build && node_modules/.bin/testcafe chrome test/testcafe/regression-tests.js --app 'node_modules/.bin/gulp serve'",regressiontest:"npm run test:regression",build:"NODE_ENV=production webpack -p && NODE_ENV=production OPTIMIZE_MINIMIZE=1 webpack -p && npm run build:node","build:node":"TARGET=node NODE_ENV=production webpack -p",profile:"webpack --profile --json > stats.json",analyze:"webpack-bundle-analyzer stats.json /dist",preversion:"npm run build && npm run test",version:"git add .",postversion:"git push && git push --tags",demo:"node ./test/demo/index.node.js"},bugs:"https://github.com/keen/keen-tracking.js/issues",author:"Keen IO <team@keen.io> (https://keen.io/)",contributors:["Dustin Larimer <dustin@keen.io> (https://github.com/dustinlarimer)","Eric Anderson <eric@keen.io> (https://github.com/aroc)","Joe Wegner <joe@keen.io> (http://www.wegnerdesign.com)","Alex Kleissner <alex@keen.io> (https://github.com/hex337)","Adam Kasprowicz <adam.kasprowicz@keen.io> (https://github.com/adamkasprowicz)"],license:"MIT",dependencies:{"component-emitter":"^1.2.0","js-cookie":"2.1.0","keen-core":"^0.1.3"},devDependencies:{"babel-loader":"^7.1.4","babel-plugin-transform-es2015-modules-commonjs":"^6.26.2","babel-plugin-transform-object-rest-spread":"^6.26.0","babel-preset-env":"^1.7.0",eslint:"^4.19.1","eslint-config-airbnb":"^16.1.0","eslint-loader":"^2.0.0","eslint-plugin-import":"^2.11.0","eslint-plugin-jsx-a11y":"^6.0.3",gulp:"^3.8.11","gulp-awspublish":"0.0.23","gulp-connect":"^5.5.0","gulp-rename":"^1.2.2","gulp-replace":"^0.5.3","html-loader":"^0.5.5","html-webpack-plugin":"^3.2.0",jest:"^22.4.3",nock:"^9.2.6","regenerator-runtime":"^0.11.1",testcafe:"^0.20.3","testcafe-browser-provider-browserstack":"^1.3.0","testcafe-browser-provider-puppeteer":"^1.3.0","testcafe-browser-provider-saucelabs":"^1.3.0",webpack:"^4.5.0","webpack-bundle-analyzer":"^2.11.1","webpack-cli":"^2.0.13","webpack-dev-server":"^3.1.1","xhr-mock":"^2.3.2"}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initAutoTrackingCore=function(e){return function(t){var n=this,o=e.helpers,r=e.utils,s=r.extend({ignoreDisabledFormFields:!1,ignoreFormFieldTypes:["password"],recordClicks:!0,recordFormSubmits:!0,recordInputChanges:!1,recordPageUnloads:!1,recordPageViews:!0,recordScrollState:!0,shareUuidAcrossDomains:!1},t);s.domElementOptions=r.extend({recordTextContent:!0,redactTextContent:!0},t.domElementOptions);var u=new Date,c=new r.cookie("keen"),a=c.get("uuid");if(!a){a=o.getUniqueId();var l=o.getDomainName(window.location.hostname),d=l&&s.shareUuidAcrossDomains?{domain:"."+l}:{};c.set("uuid",a,d)}var f=new r.cookie("prodperfect_session"),p=f.get("session_uuid");p||(p=o.getUniqueId()),f.set("session_uuid",p),f.expire(1/48);var h={};s.recordScrollState&&(h=o.getScrollState(),r.listener("window").on("scroll",function(){h=o.getScrollState(h)}));var m=u.toISOString(),g=o.getUniqueId();return n.extendEvents(function(){var e,t,n=o.getBrowserProfile();return{event_uuid:o.getUniqueId(),iso_time_full:(new Date).toISOString(),local_time_full:(new Date).toString(),session:{session_uuid:p},tracked_by:i.default.name+"-"+i.default.version,tracker_load_uuid:g,tracker_loaded_at:m,user:{uuid:a},page:{title:document?document.title:null,description:n.description,time_on_page:(e=u,t=(new Date).getTime()-e.getTime(),Math.round(t/1e3))},ip_address:"${keen.ip}",geo:{},user_agent:"${keen.user_agent}",tech:{profile:n},url:{full:window?window.location.href:"",info:{}},referrer:{full:document?document.referrer:"",info:{}},time:{local:{},utc:{}},keen:{timestamp:(new Date).toISOString(),addons:[{name:"keen:ip_to_geo",input:{ip:"ip_address"},output:"geo"},{name:"keen:ua_parser",input:{ua_string:"user_agent"},output:"tech"},{name:"keen:url_parser",input:{url:"url.full"},output:"url.info"},{name:"keen:url_parser",input:{url:"referrer.full"},output:"referrer.info"},{name:"keen:date_time_parser",input:{date_time:"keen.timestamp"},output:"time.utc"},{name:"keen:date_time_parser",input:{date_time:"iso_time_full"},output:"time.local"}]}}}),!0===s.recordClicks&&r.listener("*").on("click",function(e){var t=e.target,r={element:o.getDomNodeProfile(t,s.domElementOptions),page:{scroll_state:h}};n.recordEvent("clicks",r)}),!0===s.recordFormSubmits&&r.listener("form").on("submit",function(e){for(var t=e.target,i={disabled:s.ignoreDisabledFormFields,ignoreTypes:s.ignoreFormFieldTypes},u=r.serializeForm(t,i),c=Object.keys(u),a=0;a<c.length;a++)u[c[a]]="---REDACTED---";var l={form:{action:t.action,fields:u,method:t.method},element:o.getDomNodeProfile(t,s.domElementOptions),page:{scroll_state:h}};n.recordEvent("form_submissions",l)}),!0===s.recordInputChanges&&r.listener("*").on("change",function(e){var t=e.target,r={element:o.getDomNodeProfile(t,s.domElementOptions),page:{scroll_state:o.getScrollState}};n.recordEvent("changes",r)}),!0===s.recordPageUnloads&&window.addEventListener&&window.addEventListener("beforeunload",function(e){n.recordEvent("pageunloads")},!1),!0===s.recordPageViews&&n.recordEvent("pageviews"),n}};var o,r=n(20),i=(o=r)&&o.__esModule?o:{default:o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.deferEvent=function(e,t){if(2!==arguments.length||"string"!=typeof e)return void u.call(this,"Incorrect arguments provided to #deferEvent method");this.queue.events[e]=this.queue.events[e]||[],this.queue.events[e].push(t),this.queue.capacity++,this.queue.timer||this.queue.start();return this.emit("deferEvent",e,t),this},t.deferEvents=function(e){var t=this;if(1!==arguments.length||"object"!==(void 0===e?"undefined":o(e)))return void u.call(this,"Incorrect arguments provided to #deferEvents method");return(0,r.default)(e,function(e,n){t.queue.events[n]=t.queue.events[n]||[],t.queue.events[n]=t.queue.events[n].concat(e),t.queue.capacity=t.queue.capacity+e.length,t.queue.timer||t.queue.start()}),t.emit("deferEvents",e),t},t.queueCapacity=function(e){return arguments.length?(this.queue.config.capacity=e?Number(e):0,this.queue.check(),this):this.queue.config.capacity},t.queueInterval=function(e){return arguments.length?(this.queue.config.interval=e?Number(e):0,this.queue.check(),this):this.queue.config.interval},t.recordDeferredEvents=function(){var e,t,n=this;n.queue.capacity>0&&(n.queue.pause(),e=JSON.parse(JSON.stringify(n.queue.config)),t=JSON.parse(JSON.stringify(n.queue.events)),n.queue=(0,i.queue)(),n.queue.config=e,n.queue.on("flush",function(){n.recordDeferredEvents()}),n.emit("recordDeferredEvents",t),n.recordEvents(t,function(e,o){e?n.recordEvents(t):t=void 0}));return n},t.unloadDeferredEvents=function(){self.queue.pause(),(0,r.default)(self.queue.events,function(e,t){self.recordEvent(t,e)})};s(n(3));var r=s(n(0)),i=n(9);function s(e){return e&&e.__esModule?e:{default:e}}function u(e){var t="Event(s) not deferred: "+e;this.emit("error",t)}},function(e,t){e.exports={map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){"use strict";var t,n,o,r,i,s,u,c="",a=0,l=this.map;for(e=this.utf8.encode(e);a<e.length;)t=e.charCodeAt(a++),n=e.charCodeAt(a++),o=e.charCodeAt(a++),r=t>>2,i=(3&t)<<4|n>>4,s=isNaN(n)?64:(15&n)<<2|o>>6,u=isNaN(n)||isNaN(o)?64:63&o,c=c+l.charAt(r)+l.charAt(i)+l.charAt(s)+l.charAt(u);return c},decode:function(e){"use strict";var t,n,o,r,i,s,u="",c=0,a=this.map,l=String.fromCharCode;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<e.length;)t=a.indexOf(e.charAt(c++)),i=(15&(n=a.indexOf(e.charAt(c++))))<<4|(o=a.indexOf(e.charAt(c++)))>>2,s=(3&o)<<6|(r=a.indexOf(e.charAt(c++))),u=u+(l(t<<2|n>>4)+(64!=o?l(i):""))+(64!=r?l(s):"");return this.utf8.decode(u)},utf8:{encode:function(e){"use strict";for(var t,n="",o=0,r=String.fromCharCode;o<e.length;)n+=(t=e.charCodeAt(o++))<128?r(t):t>127&&t<2048?r(t>>6|192)+r(63&t|128):r(t>>12|224)+r(t>>6&63|128)+r(63&t|128);return n},decode:function(e){"use strict";for(var t,n="",o=0,r=String.fromCharCode;o<e.length;)n+=(t=e.charCodeAt(o))<128?[r(t),o++][0]:t>191&&t<224?[r((31&t)<<6|63&e.charCodeAt(o+1)),o+=2][0]:[r((15&t)<<12|(63&e.charCodeAt(o+1))<<6|63&(c3=e.charCodeAt(o+2))),o+=3][0];return n}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.recordEvent=l,t.recordEvents=d,t.addEvent=function(){this.emit("error","This method has been deprecated. Check out #recordEvent: https://github.com/keen/keen-tracking.js#record-a-single-event"),l.apply(this,arguments)},t.addEvents=function(){this.emit("error","This method has been deprecated. Check out #recordEvents: https://github.com/keen/keen-tracking.js#record-multiple-events"),d.apply(this,arguments)};var r=a(n(3)),i=a(n(23)),s=a(n(0)),u=a(n(1)),c=n(8);function a(e){return e&&e.__esModule?e:{default:e}}function l(e,t,n,o){var s,a,l,d,v,y,b;if(s=this.url("events",encodeURIComponent(e)),a={},l=n,b="boolean"!=typeof o||o,f.call(this,l)){if(e&&"string"==typeof e){if(this.config.globalProperties&&(a=this.config.globalProperties(e)),(0,u.default)(a,t),y={},(0,c.getExtendedEventBody)(y,this.extensions.events),(0,c.getExtendedEventBody)(y,this.extensions.collections[e]),(0,c.getExtendedEventBody)(y,[a]),this.emit("recordEvent",e,y),!r.default.enabled)return p.call(this,"Keen.enabled is set to false.",l),!1;if(v=(d=this.url("events",encodeURIComponent(e),{api_key:this.writeKey(),data:encodeURIComponent(i.default.encode(JSON.stringify(y))),modified:(new Date).getTime()})).length<function(){if("undefined"!=typeof window&&navigator&&(-1!==navigator.userAgent.indexOf("MSIE")||navigator.appVersion.indexOf("Trident/")>0))return 2e3;return 16e3}(),b)switch(this.config.requestType){case"xhr":m.call(this,"POST",s,y,l);break;case"beacon":if(navigator.sendBeacon){var w=this.url("events",encodeURIComponent(e),{api_key:this.writeKey()});navigator.sendBeacon(w,JSON.stringify(y))}else v?function(e,t){var n=this,o=t,r=document.createElement("img");t=null,r.onload=function(){if(!0,"naturalHeight"in this){if(this.naturalHeight+this.naturalWidth===0)return void this.onerror()}else if(this.width+this.height===0)return void this.onerror();o&&o.call(n)},r.onerror=function(){!0,o&&o.call(n,"An error occurred!",null)},r.src=e+"&c=clv1"}.call(this,d,l):h.call(this,s,y,"Beacon URL length exceeds current browser limit, and XHR is not supported.",l);break;default:v?function(e,t){var n=this,o=t,r=(new Date).getTime(),i=document.createElement("script"),s=document.getElementsByTagName("head")[0],u="keenJSONPCallback",c=!1;t=null,u+=r;for(;u in window;)u+="a";function a(){o&&o.call(n,"An error occurred!",null)}function l(){window[u]=void 0;try{delete window[u]}catch(e){}s.removeChild(i)}window[u]=function(e){!0!==c&&(c=!0,o&&o.call(n,null,e),l())},i.src=e+"&jsonp="+u,s.appendChild(i),i.onreadystatechange=function(){!1===c&&"loaded"===this.readyState&&(c=!0,a(),l())},i.onerror=function(){!1===c&&(c=!0,a(),l())}}.call(this,d,l):h.call(this,s,y,"JSONp URL length exceeds current browser limit, and XHR is not supported.",l)}else v&&function(e){var t=g();t&&(t.open("GET",e,!1),t.send(null))}(d);return n=l=null,this}p.call(this,"Collection name must be a string.",l)}}function d(e,t){var n,i,a,l=this;if(n=this.url("events"),i=t,t=null,f.call(this,i))if("object"!==(void 0===e?"undefined":o(e))||e instanceof Array)p.call(this,"First argument must be an object",i);else{if(!(arguments.length>2))return this.config.globalProperties&&(0,s.default)(e,function(t,n){(0,s.default)(t,function(t,o){var r=l.config.globalProperties(n);e[n][o]=(0,u.default)(r,t)})}),a={},(0,s.default)(e,function(e,t){a[t]=a[t]||[],(0,s.default)(e,function(e,n){var o={};(0,c.getExtendedEventBody)(o,l.extensions.events),(0,c.getExtendedEventBody)(o,l.extensions.collections[t]),(0,c.getExtendedEventBody)(o,[e]),a[t].push(o)})}),this.emit("recordEvents",a),r.default.enabled?(g()&&m.call(this,"POST",n,a,i),t=i=null,this):(p.call(this,"Keen.enabled is set to false.",i),!1);p.call(this,"Incorrect arguments provided to #recordEvents method",i)}}function f(e){var t=e;return e=null,this.projectId()?!!this.writeKey()||(p.call(this,"Keen.Client is missing a writeKey property.",t),!1):(p.call(this,"Keen.Client is missing a projectId property.",t),!1)}function p(e,t){var n="Event(s) not recorded: "+e;this.emit("error",n),t&&(t.call(this,n,null),t=null)}function h(e,t,n,o){g()?m.call(this,"POST",e,t,o):p.call(this,n)}function m(e,t,n,o){var i,s=this,u=g(),c=o;o=null,u.onreadystatechange=function(){var e;if(4==u.readyState)if(u.status>=200&&u.status<300){try{e=JSON.parse(u.responseText)}catch(e){r.default.emit("error","Could not parse HTTP response: "+u.responseText),c&&c.call(s,u,null)}c&&e&&c.call(s,null,e)}else r.default.emit("error","HTTP request failed."),c&&c.call(s,u,null)},u.open(e,t,!0),u.setRequestHeader("Authorization",s.writeKey()),u.setRequestHeader("Content-Type","application/json"),n&&(i=JSON.stringify(n)),"GET"===e.toUpperCase()&&u.send(),"POST"===e.toUpperCase()&&u.send(i)}function g(){var e="undefined"==typeof window?this:window;if(e.XMLHttpRequest&&("file:"!=e.location.protocol||!e.ActiveXObject))return new XMLHttpRequest;try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.listenerCore=void 0;r(n(2));var o=r(n(0));function r(e){return e&&e.__esModule?e:{default:e}}t.listenerCore=function(e){function t(e){if(e)return this instanceof t==!1?new t(e):(this.selector=e,this)}return e.domListeners=e.domListeners||{},t.prototype.on=function(t,n){var r;return 2!==arguments.length||"string"!=typeof t||"function"!=typeof n?this:(void 0===e.domListeners[t]&&(!function(e,t){document.addEventListener?document.addEventListener(e,t,!1):document.attachEvent("on"+e,t)}(t,(r=t,function(t){var n,i;n=t||window.event,i=n.target||n.srcElement,"undefined"!==e.domListeners[r]&&(0,o.default)(e.domListeners[r],function(e,t){!function(e,t){for(var n=(e.parentNode||document).querySelectorAll(t)||[],o=n.length;o--;)if(n[o]==e)return!0;return!1}(i,t)?"window"===t&&(0,o.default)(e,function(e,t){e(n)}):(0,o.default)(e,function(e,t){e(n)})})})),e.domListeners[t]={}),e.domListeners[t][this.selector]=e.domListeners[t][this.selector]||[],e.domListeners[t][this.selector].push(n),this)},t.prototype.once=function(e,t){var n=this;function o(){return n.off(e,o),t.apply(n,arguments)}return o.fn=t,n.on(e,o),n},t.prototype.off=function(t,n){var r=this,i=[];if(2===arguments.length)(0,o.default)(e.domListeners[t][r.selector],function(e,t){e!==n&&e.fn!==n&&i.push(e)}),e.domListeners[t][r.selector]=i;else if(1===arguments.length)try{delete e.domListeners[t][r.selector]}catch(n){e.domListeners[t][r.selector]=[]}else(0,o.default)(e.domListeners,function(t,n){try{delete e.domListeners[n][r.selector]}catch(t){e.domListeners[n][r.selector]=function(){}}});return r},t}},function(e,t,n){var o=n(0);n(1);e.exports=function(e){var t=[];return o(e,function(e,n){"string"!=typeof e&&(e=JSON.stringify(e)),t.push(n+"="+encodeURIComponent(e))}),t.join("&")}},function(e,t){e.exports=function(e){var t,n={},o=/\+/g,r=/([^&=]+)=?([^&]*)/g,i=function(e){return decodeURIComponent(e.replace(o," "))},s=e.split("?")[1];for(;t=r.exec(s);)n[i(t[1])]=i(t[2]);return n}},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){(function(t){(function(t){var o=t.Keen||void 0,r=n(0),i=n(1),s=n(27),u=n(26),c=n(2);function a(e){if(this instanceof a==!1)return new a(e);this.configure(e),a.debug&&this.on("error",a.log),this.emit("ready"),a.emit("client",this)}function l(e){return void 0!==e}o&&void 0===o.resources&&(a.legacyVersion=o),c(a),c(a.prototype),i(a,{debug:!1,enabled:!0,loaded:!1,version:"__VERSION__"}),a.helpers=a.helpers||{},a.resources=a.resources||{},i(a.resources,{base:"{protocol}://{host}",version:"{protocol}://{host}/3.0",projects:"{protocol}://{host}/3.0/projects",projectId:"{protocol}://{host}/3.0/projects/{projectId}",events:"{protocol}://{host}/3.0/projects/{projectId}/events",queries:"{protocol}://{host}/3.0/projects/{projectId}/queries"}),a.utils=a.utils||{},i(a.utils,{each:r,extend:i,parseParams:s,serialize:u}),a.extendLibrary=function(e,t){var n=o||t;return l(n)&&l(n.resources)&&(r(n,function(t,n){"object"==typeof t?(e[n]=e[n]||{},i(e[n],t)):e[n]=e[n]||t}),i(e.prototype,n.prototype)),e},a.log=function(e){a.debug&&"object"==typeof console&&console.log("[Keen]",e)},a.noConflict=function(){return void 0!==t.Keen&&(t.Keen=a.legacyVersion||o),a},a.ready=function(e){a.loaded?e():a.once("ready",e)},a.prototype.configure=function(e){var t=e||{};return this.config=this.config||{projectId:void 0,writeKey:void 0,host:"api.keen.io",protocol:"https",requestType:"jsonp",resources:i({},a.resources)},"undefined"!=typeof window&&window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1&&(t.protocol=document.location.protocol.replace(":","")),t.host&&t.host.replace(/.*?:\/\//g,""),i(this.config,t),this},a.prototype.masterKey=function(e){return arguments.length?(this.config.masterKey=e?String(e):null,this):this.config.masterKey},a.prototype.projectId=function(e){return arguments.length?(this.config.projectId=e?String(e):null,this):this.config.projectId},a.prototype.resources=function(e){if(!arguments.length)return this.config.resources;var t=this;return"object"==typeof e&&r(e,function(e,n){t.config.resources[n]=e||null}),t},a.prototype.url=function(e){var t,n=Array.prototype.slice.call(arguments,1),o=this.config.resources.base||"{protocol}://{host}";return t=e&&"string"==typeof e?this.config.resources[e]?this.config.resources[e]:o+e:o,r(this.config,function(e,n){"object"!=typeof e&&(t=t.replace("{"+n+"}",e))}),r(n,function(e,n){"string"==typeof e?t+="/"+e:"object"==typeof e&&(t+="?",r(e,function(e,n){t+=n+"="+e+"&"}),t=t.slice(0,-1))}),t},function(e){if(a.loaded||"undefined"==typeof document)return void e();null==document.readyState&&document.addEventListener&&(document.addEventListener("DOMContentLoaded",function e(){document.removeEventListener("DOMContentLoaded",e,!1),document.readyState="complete"},!1),document.readyState="loading");!function e(t){/in/.test(document.readyState)?setTimeout(function(){e(t)},9):t()}(e)}(function(){a.loaded=!0,a.emit("ready")}),e.exports=a}).call(this,"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{})}).call(this,n(28))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Keen=void 0;var o=k(n(3)),r=k(n(0)),i=k(n(1)),s=n(25),u=n(24),c=n(22),a=n(8),l=n(21),d=n(19),f=n(18),p=n(17),h=n(4),m=n(16),g=n(6),v=n(15),y=n(14),b=n(5),w=n(13),x=n(7),_=n(11),E=n(10);function k(e){return e&&e.__esModule?e:{default:e}}(0,i.default)(o.default.prototype,{recordEvent:u.recordEvent,recordEvents:u.recordEvents,addEvent:u.addEvent,addEvents:u.addEvents}),(0,i.default)(o.default.prototype,{deferEvent:c.deferEvent,deferEvents:c.deferEvents,queueCapacity:c.queueCapacity,queueInterval:c.queueInterval,recordDeferredEvents:c.recordDeferredEvents}),(0,i.default)(o.default.prototype,{extendEvent:a.extendEvent,extendEvents:a.extendEvents});var S=(0,l.initAutoTrackingCore)(o.default);(0,i.default)(o.default.prototype,{initAutoTracking:S}),o.default.prototype.trackExternalLink=function(e,t,n,o,r){this.emit("error","This method has been deprecated. Check out DOM listeners: https://github.com/keen/keen-tracking.js#listeners");var i,s=e,u=s.currentTarget?s.currentTarget:s.srcElement||s.target,c=o||500,a=!1,l="";void 0!==u.getAttribute?l=u.getAttribute("target"):u.target&&(l=u.target);"_blank"!=l&&"blank"!=l||s.metaKey||(window.open("about:blank").document.location=u.href);"A"===u.nodeName?i=function(){a||s.metaKey||"_blank"===l||"blank"===l||(a=!0,window.location=u.href)}:"FORM"===u.nodeName?i=function(){a||(a=!0,u.submit())}:this.trigger("error","#trackExternalLink method not attached to an <a> or <form> DOM element");r&&(i=function(){a||(a=!0,r())});if(this.recordEvent(t,n,i),setTimeout(i,c),!s.metaKey)return!1},(0,i.default)(o.default.helpers,{getBrowserProfile:d.getBrowserProfile,getDatetimeIndex:f.getDatetimeIndex,getDomainName:p.getDomainName,getDomNodePath:h.getDomNodePath,getDomNodeProfile:m.getDomNodeProfile,getScreenProfile:g.getScreenProfile,getScrollState:v.getScrollState,getUniqueId:y.getUniqueId,getWindowProfile:b.getWindowProfile});var j=(0,s.listenerCore)(o.default);(0,i.default)(o.default.utils,{cookie:w.cookie,deepExtend:x.deepExtend,listener:j,serializeForm:_.serializeForm,timer:E.timer}),o.default.listenTo=function(e){(0,r.default)(e,function(e,t){var n=t.split(" "),o=n[0],r=n.slice(1,n.length).join(" ");return j(r).on(o,e)})},Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>>>0,n=Number(arguments[1])||0;for((n=n<0?Math.ceil(n):Math.floor(n))<0&&(n+=t);n<t;n++)if(n in this&&this[n]===e)return n;return-1});var O=t.Keen=o.default.extendLibrary(o.default);t.default=O}])});
//# sourceMappingURL=keen-tracking.min.js.map